<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>


<filter firewall.log>
  @type record_transformer
  <record>
    parsed_log ${record["log"].split(" ").map(item => item.split("=")).reduce((acc, [key, value]) => { acc[key.replace(/"/g, "")] = value.replace(/"/g, ""); return acc; }, {})}
  </record>
</filter>



<match firewall.log>
  @type stdout
</match>










===============================




<source>
  @type udp
  port 5514
  bind 0.0.0.0
  format /<(?<priority>\d+)>date=(?<date>\d{4}-\d{2}-\d{2}) time=(?<time>\d{2}:\d{2}:\d{2}) devname=\"(?<devname>[^"]+)\" devid=\"(?<devid>[^"]+)\" eventtime=(?<eventtime>\d+) tz=\"(?<tz>[^"]+)\" logid=\"(?<logid>[^"]+)\" type=\"(?<type>[^"]+)\" subtype=\"(?<subtype>[^"]+)\" level=\"(?<level>[^"]+)\" vd=\"(?<vd>[^"]+)\" srcip=(?<srcip>\d+\.\d+\.\d+\.\d+) srcname=\"(?<srcname>[^"]+)\" srcport=(?<srcport>\d+) srcintf=\"(?<srcintf>[^"]+)\" srcintfrole=\"(?<srcintfrole>[^"]+)\" dstip=(?<dstip>\d+\.\d+\.\d+\.\d+) dstport=(?<dstport>\d+) dstintf=\"(?<dstintf>[^"]+)\" dstintfrole=\"(?<dstintfrole>[^"]+)\" srccountry=\"(?<srccountry>[^"]+)\" dstcountry=\"(?<dstcountry>[^"]+)\" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action=\"(?<action>[^"]+)\" policyid=(?<policyid>\d+) policytype=\"(?<policytype>[^"]+)\" poluuid=\"(?<poluuid>[^"]+)\" policyname=\"(?<policyname>[^"]+)\" service=\"(?<service>[^"]+)\" trandisp=\"(?<trandisp>[^"]+)\" duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat=\"(?<appcat>[^"]+)\" crscore=(?<crscore>\d+) craction=(?<craction>\d+) crlevel=\"(?<crlevel>[^"]+)\" srchwvendor=\"(?<srchwvendor>[^"]+)\" devtype=\"(?<devtype>[^"]+)\" srcfamily=\"(?<srcfamily>[^"]+)\" osname=\"(?<osname>[^"]+)\" srchwversion=\"(?<srchwversion>[^"]+)\" srcswversion=\"(?<srcswversion>[^"]+)\" mastersrcmac=\"(?<mastersrcmac>[^"]+)\" srcmac=\"(?<srcmac>[^"]+)\" srcserver=(?<srcserver>\d+)/
  time_format %Y-%m-%d %H:%M:%S
  tag udp.logs
</source>
<filter udp.logs>
  @type record_transformer
  enable_ruby true
  <record>
    priority ${record["priority"]}
    date ${record["date"]}
    time ${record["time"]}
    devname ${record["devname"]}
    devid ${record["devid"]}
    eventtime ${record["eventtime"]}
    tz ${record["tz"]}
    logid ${record["logid"]}
    type ${record["type"]}
    subtype ${record["subtype"]}
    level ${record["level"]}
    vd ${record["vd"]}
    srcip ${record["srcip"]}
    srcname ${record["srcname"]}
    srcport ${record["srcport"]}
    srcintf ${record["srcintf"]}
    srcintfrole ${record["srcintfrole"]}
    dstip ${record["dstip"]}
    dstport ${record["dstport"]}
    dstintf ${record["dstintf"]}
    dstintfrole ${record["dstintfrole"]}
    srccountry ${record["srccountry"]}
    dstcountry ${record["dstcountry"]}
    sessionid ${record["sessionid"]}
    proto ${record["proto"]}
    action ${record["action"]}
    policyid ${record["policyid"]}
    policytype ${record["policytype"]}
    poluuid ${record["poluuid"]}
    policyname ${record["policyname"]}
    service ${record["service"]}
    trandisp ${record["trandisp"]}
    duration ${record["duration"]}
    sentbyte ${record["sentbyte"]}
    rcvdbyte ${record["rcvdbyte"]}
    sentpkt ${record["sentpkt"]}
    rcvdpkt ${record["rcvdpkt"]}
    appcat ${record["appcat"]}
    crscore ${record["crscore"]}
    craction ${record["craction"]}
    crlevel ${record["crlevel"]}
    srchwvendor ${record["srchwvendor"]}
    devtype ${record["devtype"]}
    srcfamily ${record["srcfamily"]}
    osname ${record["osname"]}
    srchwversion ${record["srchwversion"]}
    srcswversion ${record["srcswversion"]}
    mastersrcmac ${record["mastersrcmac"]}
    srcmac ${record["srcmac"]}
    srcserver ${record["srcserver"]}
  </record>
</filter>

<match udp.logs>
  @type http
  endpoint http://localhost:8088/finevo-fortigate
  json_array true
  <format>
    @type json
  </format>
  <buffer>
    flush_interval 10s
  </buffer>
</match>








"<189>date=2024-07-26 time=15:03:26 devname=\"OFFICE-FW\" devid=\"FG101ETK19010698\" eventtime=1721973806879463897 tz=\"+0900\" logid=\"0000000013\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" srcip=172.20.10.35 srcname=\"SUHWAN-PARK\" srcport=58534 srcintf=\"vlan_10\" srcintfrole=\"lan\" dstip=172.217.175.234 dstport=443 dstintf=\"wan1\" dstintfrole=\"wan\" srccountry=\"Reserved\" dstcountry=\"United States\" sessionid=102689794 proto=6 action=\"deny\" policyid=0 policytype=\"policy\" service=\"HTTPS\" trandisp=\"noop\" duration=0 sentbyte=0 rcvdbyte=0 sentpkt=0 rcvdpkt=0 appcat=\"unscanned\" crscore=30 craction=131072 crlevel=\"high\" srchwvendor=\"Dell\" devtype=\"Home & Office\" srcfamily=\"Computer\" osname=\"Windows\" srcswversion=\"10\" unauthuser=\"finance@finevo.io\" unauthusersource=\"pop3\" mastersrcmac=\"70:b5:e8:28:a0:a9\" srcmac=\"70:b5:e8:28:a0:a9\" srcserver=0"


<source>
  @type udp
  port 5140
  tag your_input_tag
</source>

<filter your_input_tag>
  @type parser
  key_name log
  <parse>
    @type regexp
    expression /(?<key>[^=]+)=(?<value>[^ ]+)/
    time_format %Y-%m-%d %H:%M:%S
  </parse>
</filter>

<match your_input_tag>
  @type stdout
</match>

==================================


<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>

<filter firewall.log>
  @type record_transformer
  enable_ruby true
  <record>
    parsed_log ${record["message"].split(" ").map { |item| item.split("=") }.reduce({}) { |acc, (key, value)| acc[key.gsub(/"/, "")] = value.gsub(/"/, ""); acc }}
  </record>
</filter>

<match firewall.log>
  @type stdout
  output_type json
</match>



====

<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>

<filter firewall.log>
  @type record_transformer
  enable_ruby true
  <record>
    parsed_log ${record["log"].split(" ").map { |item| item.split("=") }.to_h}
  </record>
</filter>

<match firewall.log>
  @type stdout
  output_type json
</match> 










===============

<source>
  @type udp
  port 6514
  bind 0.0.0.0
  format /<(?<priority>\d+)>date=(?<date>\d{4}-\d{2}-\d{2}) time=(?<time>\d{2}:\d{2}:\d{2}) devname=\"(?<devname>[^\"]+)\" devid=\"(?<devid>[^\"]+)\" eventtime=(?<eventtime>\d+) tz=\"(?<tz>[^\"]+)\" logid=\"(?<logid>[^\"]+)\" type=\"(?<type>[^\"]+)\" subtype=\"(?<subtype>[^\"]+)\" level=\"(?<level>[^\"]+)\" vd=\"(?<vd>[^\"]+)\" srcip=(?<srcip>\d+\.\d+\.\d+\.\d+) srcname=\"(?<srcname>[^\"]+)\" srcport=(?<srcport>\d+) srcintf=\"(?<srcintf>[^\"]+)\" srcintfrole=\"(?<srcintfrole>[^\"]+)\" dstip=(?<dstip>\d+\.\d+\.\d+\.\d+) dstport=(?<dstport>\d+) dstintf=\"(?<dstintf>[^\"]+)\" dstintfrole=\"(?<dstintfrole>[^\"]+)\" srccountry=\"(?<srccountry>[^\"]+)\" dstcountry=\"(?<dstcountry>[^\"]+)\" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action=\"(?<action>[^\"]+)\" policyid=(?<policyid>\d+) policytype=\"(?<policytype>[^\"]+)\" poluuid=\"(?<poluuid>[^\"]+)?\" policyname=\"(?<policyname>[^\"]+)?\" service=\"(?<service>[^\"]+)\" trandisp=\"(?<trandisp>[^\"]+)\" duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat=\"(?<appcat>[^\"]+)\" crscore=(?<crscore>\d+) craction=(?<craction>\d+) crlevel=\"(?<crlevel>[^\"]+)\" srchwvendor=\"(?<srchwvendor>[^\"]+)\" devtype=\"(?<devtype>[^\"]+)\" srcfamily=\"(?<srcfamily>[^\"]+)\" osname=\"(?<osname>[^\"]+)\" srchwversion=\"(?<srchwversion>[^\"]+)\" srcswversion=\"(?<srcswversion>[^\"]+)\" unauthuser=\"(?<unauthuser>[^\"]+)?\" unauthusersource=\"(?<unauthusersource>[^\"]+)?\" mastersrcmac=\"(?<mastersrcmac>[^\"]+)\" srcmac=\"(?<srcmac>[^\"]+)\" srcserver=(?<srcserver>\d+)/
  time_format %Y-%m-%d %H:%M:%S
  tag firewall.log
</source>

<filter firewall.log>
  @type record_transformer
  enable_ruby true
  <record>
    priority ${record["priority"]}
    date ${record["date"]}
    time ${record["time"]}
    devname ${record["devname"]}
    devid ${record["devid"]}
    eventtime ${record["eventtime"]}
    tz ${record["tz"]}
    logid ${record["logid"]}
    type ${record["type"]}
    subtype ${record["subtype"]}
    level ${record["level"]}
    vd ${record["vd"]}
    srcip ${record["srcip"]}
    srcname ${record["srcname"]}
    srcport ${record["srcport"]}
    srcintf ${record["srcintf"]}
    srcintfrole ${record["srcintfrole"]}
    dstip ${record["dstip"]}
    dstport ${record["dstport"]}
    dstintf ${record["dstintf"]}
    dstintfrole ${record["dstintfrole"]}
    srccountry ${record["srccountry"]}
    dstcountry ${record["dstcountry"]}
    sessionid ${record["sessionid"]}
    proto ${record["proto"]}
    action ${record["action"]}
    policyid ${record["policyid"]}
    policytype ${record["policytype"]}
    poluuid ${record["poluuid"]}
    policyname ${record["policyname"]}
    service ${record["service"]}
    trandisp ${record["trandisp"]}
    duration ${record["duration"]}
    sentbyte ${record["sentbyte"]}
    rcvdbyte ${record["rcvdbyte"]}
    sentpkt ${record["sentpkt"]}
    rcvdpkt ${record["rcvdpkt"]}
    appcat ${record["appcat"]}
    crscore ${record["crscore"]}
    craction ${record["craction"]}
    crlevel ${record["crlevel"]}
    srchwvendor ${record["srchwvendor"]}
    devtype ${record["devtype"]}
    srcfamily ${record["srcfamily"]}
    osname ${record["osname"]}
    srchwversion ${record["srchwversion"]}
    srcswversion ${record["srcswversion"]}
    unauthuser ${record["unauthuser"]}
    unauthusersource ${record["unauthusersource"]}
    mastersrcmac ${record["mastersrcmac"]}
    srcmac ${record["srcmac"]}
    srcserver ${record["srcserver"]}
  </record>
</filter>

<match firewall.log>
  @type http
  endpoint http://localhost:8088/finevo-fortigate
  json_array true
  <format>
    @type json
  </format>
  <buffer>
    flush_interval 10s
  </buffer>
</match>



<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>

<match firewall.log>
	@type copy
	<store>
		@type stdout
		output_type json
	</store>
	<store>
		@type http
		endpoint http://localhost:8088/finevo-fortigate
		json_array true
		<format>
			@type json
		</format>
		<buffer>
			flush_interval 10s
		</buffer>
	</store>
</match>


2024-07-26 06:44:35.729542017 +0000 firewall.log: {"message":"<189>date=2024-07-26 time=15:44:35 devname=\"OFFICE-FW\" devid=\"FG101ETK19010698\" eventtime=1721976275378531481 tz=\"+0900\" logid=\"0000000013\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" srcip=172.20.30.36 srcname=\"DESKTOP-COSFCJO\" srcport=10204 srcintf=\"vlan_30\" srcintfrole=\"lan\" dstip=172.26.6.112 dstport=14200 dstintf=\"KT_IPSec\" dstintfrole=\"undefined\" srccountry=\"Reserved\" dstcountry=\"Reserved\" sessionid=102732450 proto=6 action=\"close\" policyid=56 policytype=\"policy\" poluuid=\"f11a4484-d87a-51ea-be29-b0d675e449e0\" policyname=\"KT_IPSec_v30_HIWARE\" service=\"Hiware_14200\" trandisp=\"noop\" duration=3 sentbyte=1526 rcvdbyte=3412 sentpkt=11 rcvdpkt=14 vpntype=\"ipsecvpn\" appcat=\"unscanned\" srchwvendor=\"Dell\" devtype=\"Home & Office\" srcfamily=\"Computer\" osname=\"Windows\" srcswversion=\"10\" unauthuser=\"bhkim\" unauthusersource=\"imap\" mastersrcmac=\"70:b5:e8:2c:10:bc\" srcmac=\"70:b5:e8:2c:10:bc\" srcserver=0"}
2024-07-26 06:44:35.729621498 +0000 firewall.log: {"message":"<189>date=2024-07-26 time=15:44:35 devname=\"OFFICE-FW\" devid=\"FG101ETK19010698\" eventtime=1721976275648534010 tz=\"+0900\" logid=\"0000000013\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" srcip=172.20.20.42 srcname=\"DESKTOP-RF9RKVQ\" srcport=55897 srcintf=\"vlan_20\" srcintfrole=\"lan\" dstip=172.26.6.112 dstport=14200 dstintf=\"KT_IPSec\" dstintfrole=\"undefined\" srccountry=\"Reserved\" dstcountry=\"Reserved\" sessionid=102732456 proto=6 action=\"close\" policyid=59 policytype=\"policy\" poluuid=\"60428eec-d881-51ea-377a-e80b77ac961c\" policyname=\"KT_IPSec_v20_HIWARE\" service=\"Hiware_14200\" trandisp=\"noop\" duration=3 sentbyte=1566 rcvdbyte=3412 sentpkt=12 rcvdpkt=14 vpntype=\"ipsecvpn\" appcat=\"unscanned\" srchwvendor=\"GIGA-BYTE\" osname=\"Windows\" srcswversion=\"10\" unauthuser=\"sootdeng2@finevo.io\" unauthusersource=\"pop3\" mastersrcmac=\"b4:2e:99:a7:5e:e0\" srcmac=\"b4:2e:99:a7:5e:e0\" srcserver=0"}



===
<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>

<filter firewall.log>
  @type record_transformer
  <record>
    message ${record["message"].gsub(/<\d+>/, '').split(' ').map { |s| s.split('=') }.to_h.to_json}
  </record>
</filter>