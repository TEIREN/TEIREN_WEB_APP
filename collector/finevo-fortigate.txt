<source>
  @type udp
  port 5140
  bind 0.0.0.0
  format /^(?<priority><\d+>)date=(?<date>[^ ]+) time=(?<time>[^ ]+) devname="(?<devname>[^"]+)" devid="(?<devid>[^"]+)" eventtime=(?<eventtime>\d+) tz="(?<tz>[^"]+)" logid="(?<logid>[^"]+)" type="(?<type>[^"]+)" subtype="(?<subtype>[^"]+)" level="(?<level>[^"]+)" vd="(?<vd>[^"]+)" srcip=(?<srcip>[^ ]+) srcname="(?<srcname>[^"]+)" srcport=(?<srcport>\d+) srcintf="(?<srcintf>[^"]+)" srcintfrole="(?<srcintfrole>[^"]+)" dstip=(?<dstip>[^ ]+) dstport=(?<dstport>\d+) dstintf="(?<dstintf>[^"]+)" dstintfrole="(?<dstintfrole>[^"]+)" srccountry="(?<srccountry>[^"]+)" dstcountry="(?<dstcountry>[^"]+)" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action="(?<action>[^"]+)" policyid=(?<policyid>\d+) policytype="(?<policytype>[^"]+)" poluuid="(?<poluuid>[^"]+)" policyname="(?<policyname>[^"]+)" service="(?<service>[^"]+)" trandisp="(?<trandisp>[^"]+)" duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat="(?<appcat>[^"]+)" crscore=(?<crscore>\d+) craction=(?<craction>\d+) crlevel="(?<crlevel>[^"]+)" srchwvendor="(?<srchwvendor>[^"]+)" devtype="(?<devtype>[^"]+)" srcfamily="(?<srcfamily>[^"]+)" osname="(?<osname>[^"]+)" srchwversion="(?<srchwversion>[^"]+)" srcswversion="(?<srcswversion>[^"]+)" mastersrcmac="(?<mastersrcmac>[^"]+)" srcmac="(?<srcmac>[^"]+)" srcserver=(?<srcserver>\d+)/
  tag firewall.log
</source>


<source>
  @type udp
  port 5514
  bind 0.0.0.0
  format /<(?<priority>\d+)>(?<date>\d{4}-\d{2}-\d{2}) (?<time>\d{2}:\d{2}:\d{2}) devname="(?<devname>[^"]+)" devid="(?<devid>[^"]+)" eventtime=(?<eventtime>\d+) tz="(?<tz>[^"]+)" logid="(?<logid>[^"]+)" type="(?<type>[^"]+)" subtype="(?<subtype>[^"]+)" level="(?<level>[^"]+)" vd="(?<vd>[^"]+)" srcip=(?<srcip>\d+\.\d+\.\d+\.\d+) srcname="(?<srcname>[^"]+)" srcport=(?<srcport>\d+) srcintf="(?<srcintf>[^"]+)" srcintfrole="(?<srcintfrole>[^"]+)" dstip=(?<dstip>\d+\.\d+\.\d+\.\d+) dstport=(?<dstport>\d+) dstintf="(?<dstintf>[^"]+)" dstintfrole="(?<dstintfrole>[^"]+)" srccountry="(?<srccountry>[^"]+)" dstcountry="(?<dstcountry>[^"]+)" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action="(?<action>[^"]+)" policyid=(?<policyid>\d+) policytype="(?<policytype>[^"]+)" poluuid="(?<poluuid>[^"]+)" policyname="(?<policyname>[^"]+)" service="(?<service>[^"]+)" trandisp="(?<trandisp>[^"]+)" duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat="(?<appcat>[^"]+)" crscore=(?<crscore>\d+) craction=(?<craction>\d+) crlevel="(?<crlevel>[^"]+)" srchwvendor="(?<srchwvendor>[^"]+)" devtype="(?<devtype>[^"]+)" srcfamily="(?<srcfamily>[^"]+)" osname="(?<osname>[^"]+)" srchwversion="(?<srchwversion>[^"]+)" srcswversion="(?<srcswversion>[^"]+)" mastersrcmac="(?<mastersrcmac>[^"]+)" srcmac="(?<srcmac>[^"]+)" srcserver=(?<srcserver>\d+)/
  time_format %Y-%m-%d %H:%M:%S
  tag firewall.log
</source>


<filter firewall.log>
  @type record_transformer
  enable_ruby
  <record>
    log_time ${record["date"]} ${record["time"]}
    src_info ${record["srcip"]} (${record["srcname"]}:${record["srcport"]})
    dst_info ${record["dstip"]} (${record["dstintf"]}:${record["dstport"]})
    action ${record["action"]}
  </record>
</filter>



<match firewall.log>
  @type stdout
</match>








===============================




<source>
  @type udp
  port 5514
  bind 0.0.0.0
  format /<(?<priority>\d+)>date=(?<date>\d{4}-\d{2}-\d{2}) time=(?<time>\d{2}:\d{2}:\d{2}) devname="(?<devname>[^"]+)" devid="(?<devid>[^"]+)" eventtime=(?<eventtime>\d+) tz="(?<tz>[^"]+)" logid="(?<logid>[^"]+)" type="(?<type>[^"]+)" subtype="(?<subtype>[^"]+)" level="(?<level>[^"]+)" vd="(?<vd>[^"]+)" srcip=(?<srcip>\d+\.\d+\.\d+\.\d+) srcname="(?<srcname>[^"]+)" srcport=(?<srcport>\d+) srcintf="(?<srcintf>[^"]+)" srcintfrole="(?<srcintfrole>[^"]+)" dstip=(?<dstip>\d+\.\d+\.\d+\.\d+) dstport=(?<dstport>\d+) dstintf="(?<dstintf>[^"]+)" dstintfrole="(?<dstintfrole>[^"]+)" srccountry="(?<srccountry>[^"]+)" dstcountry="(?<dstcountry>[^"]+)" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action="(?<action>[^"]+)" policyid=(?<policyid>\d+) policytype="(?<policytype>[^"]+)" poluuid="(?<poluuid>[^"]+)" policyname="(?<policyname>[^"]+)" service="(?<service>[^"]+)" trandisp="(?<trandisp>[^"]+)" duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat="(?<appcat>[^"]+)" crscore=(?<crscore>\d+) craction=(?<craction>\d+) crlevel="(?<crlevel>[^"]+)" srchwvendor="(?<srchwvendor>[^"]+)" devtype="(?<devtype>[^"]+)" srcfamily="(?<srcfamily>[^"]+)" osname="(?<osname>[^"]+)" srchwversion="(?<srchwversion>[^"]+)" srcswversion="(?<srcswversion>[^"]+)" mastersrcmac="(?<mastersrcmac>[^"]+)" srcmac="(?<srcmac>[^"]+)" srcserver=(?<srcserver>\d+)/
  time_format %Y-%m-%d %H:%M:%S
  tag udp.logs
</source>
<filter udp.logs>
  @type record_transformer
  enable_ruby true
  <record>
    priority ${record["priority"]}
    date ${record["date"]}
    time ${record["time"]}
    devname ${record["devname"]}
    devid ${record["devid"]}
    eventtime ${record["eventtime"]}
    tz ${record["tz"]}
    logid ${record["logid"]}
    type ${record["type"]}
    subtype ${record["subtype"]}
    level ${record["level"]}
    vd ${record["vd"]}
    srcip ${record["srcip"]}
    srcname ${record["srcname"]}
    srcport ${record["srcport"]}
    srcintf ${record["srcintf"]}
    srcintfrole ${record["srcintfrole"]}
    dstip ${record["dstip"]}
    dstport ${record["dstport"]}
    dstintf ${record["dstintf"]}
    dstintfrole ${record["dstintfrole"]}
    srccountry ${record["srccountry"]}
    dstcountry ${record["dstcountry"]}
    sessionid ${record["sessionid"]}
    proto ${record["proto"]}
    action ${record["action"]}
    policyid ${record["policyid"]}
    policytype ${record["policytype"]}
    poluuid ${record["poluuid"]}
    policyname ${record["policyname"]}
    service ${record["service"]}
    trandisp ${record["trandisp"]}
    duration ${record["duration"]}
    sentbyte ${record["sentbyte"]}
    rcvdbyte ${record["rcvdbyte"]}
    sentpkt ${record["sentpkt"]}
    rcvdpkt ${record["rcvdpkt"]}
    appcat ${record["appcat"]}
    crscore ${record["crscore"]}
    craction ${record["craction"]}
    crlevel ${record["crlevel"]}
    srchwvendor ${record["srchwvendor"]}
    devtype ${record["devtype"]}
    srcfamily ${record["srcfamily"]}
    osname ${record["osname"]}
    srchwversion ${record["srchwversion"]}
    srcswversion ${record["srcswversion"]}
    mastersrcmac ${record["mastersrcmac"]}
    srcmac ${record["srcmac"]}
    srcserver ${record["srcserver"]}
  </record>
</filter>

<match udp.logs>
  @type http
  endpoint http://localhost:8088/finevo-fortigate
  json_array true
  <format>
    @type json
  </format>
  <buffer>
    flush_interval 10s
  </buffer>
</match>
