
<source>
  @type udp
  port 6514
  bind 0.0.0.0
  <parse>
    @type none
  </parse>
  tag firewall.log
</source>



<filter firewall.log>
  @type parser
  key_name message
  format /(?<key>\w+)=(?:"(?<value>[^"]+)"|(?<value2>\S+) )/
  reserve_data yes
</filter>

<filter firewall.log>
  @type record_transformer
  <record>
    message ${record["message"].gsub(/(?<key>\w+)=(?:"(?<value>[^"]+)"|(?<value2>\S+))/, '${key}:\'${value || value2}\'')}
  </record>
</filter>

<match firewall.log>
  @type stdout
  output_type json
</match>

  format /^(?<priority><\d+>)date=(?<date>[^ ]+) time=(?<time>[^ ]+) devname="(?<devname>[^"]+)" devid="(?<devid>[^"]+)" eventtime=(?<eventtime>\d+) tz="(?<tz>[^"]+)" logid="(?<logid>[^"]+)" type="(?<type>[^"]+)" subtype="(?<subtype>[^"]+)" level="(?<level>[^"]+)" vd="(?<vd>[^"]+)" srcip=(?<srcip>[^ ]+) srcname="(?<srcname>[^"]+)" srcport=(?<srcport>\d+) srcintf="(?<srcintf>[^"]+)" srcintfrole="(?<srcintfrole>[^"]+)" dstip=(?<dstip>[^ ]+) dstport=(?<dstport>\d+) dstintf="(?<dstintf>[^"]+)" dstintfrole="(?<dstintfrole>[^"]+)" srccountry="(?<srccountry>[^"]+)" dstcountry="(?<dstcountry>[^"]+)" sessionid=(?<sessionid>\d+) proto=(?<proto>\d+) action="(?<action>[^"]+)" policyid=(?<policyid>\d+) policytype="(?<policytype>[^"]+)" poluuid="(?<poluuid>[^"]+)" policyname="(?<policyname>[^"]+)" service="(?<service>[^"]+)" trandisp="(?<trandisp>[^"]+)" (transip=(?<transip>[^ ]+))? transport=(?<transport>\d+) duration=(?<duration>\d+) sentbyte=(?<sentbyte>\d+) rcvdbyte=(?<rcvdbyte>\d+) sentpkt=(?<sentpkt>\d+) rcvdpkt=(?<rcvdpkt>\d+) appcat="(?<appcat>[^"]+)" srchwvendor="(?<srchwvendor>[^"]+)" devtype="(?<devtype>[^"]+)" srcfamily="(?<srcfamily>[^"]+)" osname="(?<osname>[^"]+)" srcswversion="(?<srcswversion>[^"]+)" unauthuser="(?<unauthuser>[^"]+)" unauthusersource="(?<unauthusersource>[^"]+)" mastersrcmac="(?<mastersrcmac>[^"]+)" srcmac="(?<srcmac>[^"]+)" srcserver=(?<srcserver>\d+)/

===
<filter your_filter>
  @type parser
  key_name message
  format /(?<key>\w+)=(?:"(?<value>[^"]+)"|(?<value2>[^\s]+))/
  reserve_data yes
  <parse>
    @type regexp
    expression /(?<key>\w+)=(?:"(?<value>[^"]+)"|(?<value2>\S+) )/
  </parse>
</filter>