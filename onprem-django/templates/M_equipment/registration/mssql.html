{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="locationbar ml-2">
    <span>Resource Management &nbsp;&nbsp;>&nbsp;&nbsp;Integreation &nbsp;&nbsp;>&nbsp;&nbsp;<a href="/integration/registration/">Registration</a> &nbsp;&nbsp;>&nbsp;&nbsp;</span>
    <span class="current">MSSQL<span>
</div>
<div>
    <!-- Page Heading -->
    <h6 class="h3 mb-2 ml-2 font-weight-bold text-gray-800">Integrate MSSQL</h6>
    <p class="h6 mb-4 ml-2">Integrate MSSQL Logs To Teiren Cloud</p>
    <!-- Begin Page Content -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <div style="float: left">
                <h6 class="m-0 font-weight-bold text-teiren">
                    Verify MSSQL Account
                </h6>
            </div>
        </div>
        <div class="card-body" style="font-size:12px">
            <form method="POST" id='account_form'>
                <div class="form-group text-teiren">MSSQL Server IP
                    <div class="form-group text-dark">
                        <input type='text' class="form-control" id="db_server" name="db_server" placeholder="MSSQL Server IP">
                    </div>
                </div>
                <div class="form-group text-teiren">MSSQL Database Name
                    <div class="form-group text-dark">
                        <input type='text' class="form-control" id="db_name" name="db_name" placeholder="MSSQL Database Name">
                    </div>
                </div>
                <div class="form-group text-teiren">MSSQL User ID
                    <div class="form-group text-dark">
                        <input type='text' class="form-control" id="db_uid" name="db_uid" placeholder="MSSQL User ID">
                    </div>
                </div>
                <div class="form-group text-teiren">MSSQL User Password
                    <div class="form-group text-dark">
                        <input type='text' class="form-control" id="db_password" name="db_password" placeholder="MSSQL User Password">
                    </div>
                </div>
                <div class="form-group text-teiren">MSSQL Database Table Name
                    <div class="form-group text-dark">
                        <input type='text' class="form-control" id="db_table" name="db_table" placeholder="MSSQL Database Table Name">
                    </div>
                </div>
                <input type="button" class="btn btn-outline-primary" onclick="register()" id='form-check' value="Confirm MSSQL Information"/>
            </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block script %}
<script>
    function register(){
        $.ajax({
            url: '/integration/mssql/db/insert/',
            headers:{
                'X-CSRFToken': '{{csrf_token}}'
            },
            type: 'post',
            data: $('#account_form').serialize()
        }).done(function(response){
            alert(response)
            if(response.startsWith('MSSQL')){
                location.reload()
            }
        })
    }    
</script>
{% endblock %}