Detector를 위한 추가적인 fluetnd.conf 수정
</match>
<source>
  @type tail
  path /var/log/syslog
  pos_file /var/log/td-agent/syslog.pos
  tag syslog
  <parse>
    @type syslog
  </parse>
</source>

<match syslog>
  @type elasticsearch
  host elasticsearch
  port 9200
  logstash_format true
  logstash_prefix test_linux_syslog
</match>


룰셋추가
curl -X POST "http://localhost:8888/ruleset/" -H "Content-Type: application/json" -d '{
    "name": "Detect systemd failure",
    "system": "linux",
    "query": {
        "query": {
            "bool": {
                "must": [
                    {
                        "match": {
                            "message": "fail"
                        }
                    },
                    {
                        "match": {
                            "programname": "systemd"
                        }
                    }
                ]
            }
        }
    },
    "severity": 4
}'

확인
curl -X GET "localhost:9200/detected_logs/_search?pretty"


룰샛 수정 해야할듯?
