INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
/home/ubuntu/TEIREN_WEB_APP/detector/test/detectorV2.py:78: DeprecationWarning: Received 'size' via a specific parameter in the presence of a 'body' parameter, which is deprecated and will be removed in a future version. Instead, use only 'body' or only specific parameters.
  result = es.search(index=log_index_name, body=rule_query, scroll=scroll, size=size)
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [179962]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [179953]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180740]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180756]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180757]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180782]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180818]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180808]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180855]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule rule_test detected 5517 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180868]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180887]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180930]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180916]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180958]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [180974]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181000]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181071]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181061]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181171]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181231]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181280]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Rule rule_test detected 7078 logs
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Rule testtest detected 202 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181409]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule last_test detected 14270 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
ERROR:__main__:Scrolling failed: NotFoundError(404, 'search_phase_execution_exception', 'No search context found for id [181326]')
ERROR:__main__:Clearing scroll failed: NotFoundError(404, "{'succeeded': True, 'num_freed': 0}")
INFO:__main__:Rule programname_test detected 23945 logs
INFO:__main__:Found 4 rulesets in fortigate_ruleset
INFO:__main__:Applying rule: test_forti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "type": "traffic"
                    }
                },
                {
                    "match": {
                        "level": "notice"
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testforti, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: testtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "logid": "0001000014"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: lasttest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: testforti
INFO:__main__:No logs found for rule: lasttest
INFO:__main__:Rule testtest detected 202 logs
INFO:__main__:Rule test_forti detected 200 logs
INFO:__main__:Found 4 rulesets in window_ruleset
INFO:__main__:Applying rule: 중첩테스트, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventcategory": "12544"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "eventcategory": "13824"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: last_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "eventtype": "successaudit"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: tagname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "tag_name": "unknown"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: tagname_test
INFO:__main__:Rule 중첩테스트 detected 647 logs
INFO:__main__:Found 3 rulesets in genian_ruleset
INFO:__main__:Applying rule: genian, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "asfd": "asdf"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: genian_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "test": "test"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: eventtest, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "event_type": "\uc54c\ub9bc"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:No logs found for rule: genian
INFO:__main__:No logs found for rule: genian_test
INFO:__main__:Rule eventtest detected 1595 logs
INFO:__main__:Found 4 rulesets in linux_ruleset
INFO:__main__:Applying rule: severity_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "severity": "err"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: rule_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "facility": "authpriv"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                },
                {
                    "bool": {
                        "should": [
                            {
                                "bool": {
                                    "must_not": {
                                        "match": {
                                            "programname": "systemd"
                                        }
                                    }
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "sshd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Applying rule: programname_test2, Query: {
    "query": {
        "bool": {
            "must": [
                {
                    "bool": {
                        "should": [
                            {
                                "match": {
                                    "programname": "fwupd"
                                }
                            }
                        ],
                        "minimum_should_match": 1
                    }
                }
            ]
        }
    }
}
INFO:__main__:Rule rule_test detected 5517 logs
INFO:__main__:Rule programname_test2 detected 932 logs
INFO:__main__:Rule severity_test detected 1245 logs
